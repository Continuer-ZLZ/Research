{"remainingRequest":"D:\\Code\\Research\\research-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Code\\Research\\research-ui\\src\\views\\project\\acceptance\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\Code\\Research\\research-ui\\src\\views\\project\\acceptance\\index.vue","mtime":1740901762435},{"path":"D:\\Code\\Research\\research-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1740793404454},{"path":"D:\\Code\\Research\\research-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1740793410952},{"path":"D:\\Code\\Research\\research-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1740793404454},{"path":"D:\\Code\\Research\\research-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1740793415933}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIHJlc2VhcmNoLXVpL3NyYy92aWV3cy9wcm9qZWN0L2FjY2VwdGFuY2UvaW5kZXguanMKaW1wb3J0IHsgbGlzdFByb2plY3RBY2NlcHRhbmNlLCBnZXRBY2NlcHRhbmNlLCBhZGRBY2NlcHRhbmNlLCBjb21wbGV0ZUFjY2VwdGFuY2UgfSBmcm9tICJAL2FwaS9wcm9qZWN0L2FjY2VwdGFuY2UiOwppbXBvcnQgeyBnZXRJbmZvIH0gZnJvbSAiQC9hcGkvcHJvamVjdC9pbmZvIjsKaW1wb3J0IHsgZ2V0VG9rZW4gfSBmcm9tICJAL3V0aWxzL2F1dGgiOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJQcm9qZWN0QWNjZXB0YW5jZSIsCiAgZGljdHM6IFsnYWNjZXB0YW5jZV9zdGF0dXMnXSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgLy8g6YGu572p5bGCCiAgICAgIGxvYWRpbmc6IHRydWUsCiAgICAgIC8vIOmhueebrklECiAgICAgIHByb2plY3RJZDogbnVsbCwKICAgICAgLy8g6aG555uu5L+h5oGvCiAgICAgIHByb2plY3RJbmZvOiB7fSwKICAgICAgLy8g5p+l6K+i5Y+C5pWwCiAgICAgIHF1ZXJ5UGFyYW1zOiB7CiAgICAgICAgcGFnZU51bTogMSwKICAgICAgICBwYWdlU2l6ZTogMTAsCiAgICAgICAgcHJvamVjdElkOiB1bmRlZmluZWQsCiAgICAgIH0sCiAgICAgIC8vIOmqjOaUtuiusOW9leWIl+ihqAogICAgICBhY2NlcHRhbmNlTGlzdDogW10sCiAgICAgIC8vIOaAu+adoeaVsAogICAgICB0b3RhbDogMCwKICAgICAgLy8g6aqM5pS26KGo5Y2VCiAgICAgIGZvcm06IHsKICAgICAgICBwcm9qZWN0SWQ6IHVuZGVmaW5lZCwKICAgICAgICBhY2NlcHRhbmNlVGl0bGU6IHVuZGVmaW5lZCwKICAgICAgICBhY2NlcHRhbmNlQ29udGVudDogdW5kZWZpbmVkLAogICAgICAgIG1hdGVyaWFsc1BhdGg6IHVuZGVmaW5lZCwKICAgICAgfSwKICAgICAgLy8g6aqM5pS26K+m5oOF6KGo5Y2VCiAgICAgIHZpZXdGb3JtOiB7fSwKICAgICAgLy8g6aqM5pS26K+E5a6h6KGo5Y2VCiAgICAgIGFjY2VwdGFuY2VGb3JtOiB7CiAgICAgICAgaWQ6IG51bGwsCiAgICAgICAgc2NvcmU6IDUsCiAgICAgICAgb3BpbmlvbjogJycsCiAgICAgICAgc3RhdHVzOiAnMScKICAgICAgfSwKICAgICAgLy8g6KGo5Y2V5qCh6aqMCiAgICAgIHJ1bGVzOiB7CiAgICAgICAgYWNjZXB0YW5jZVRpdGxlOiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAi6aqM5pS25qCH6aKY5LiN6IO95Li656m6IiwgdHJpZ2dlcjogImJsdXIiIH0KICAgICAgICBdLAogICAgICAgIGFjY2VwdGFuY2VDb250ZW50OiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAi6aqM5pS25YaF5a655LiN6IO95Li656m6IiwgdHJpZ2dlcjogImJsdXIiIH0KICAgICAgICBdCiAgICAgIH0sCiAgICAgIC8vIOmqjOaUtuivhOWuoeihqOWNleagoemqjAogICAgICBhY2NlcHRhbmNlUnVsZXM6IHsKICAgICAgICBzY29yZTogWwogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuivhOWIhuS4jeiDveS4uuepuiIsIHRyaWdnZXI6ICJibHVyIiB9CiAgICAgICAgXSwKICAgICAgICBvcGluaW9uOiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAi6aqM5pS25oSP6KeB5LiN6IO95Li656m6IiwgdHJpZ2dlcjogImJsdXIiIH0KICAgICAgICBdLAogICAgICAgIHN0YXR1czogWwogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIumqjOaUtue7k+aenOS4jeiDveS4uuepuiIsIHRyaWdnZXI6ICJjaGFuZ2UiIH0KICAgICAgICBdCiAgICAgIH0sCiAgICAgIC8vIOivpuaDheW8ueeqlwogICAgICBvcGVuOiBmYWxzZSwKICAgICAgdGl0bGU6ICIiLAogICAgICBpc0FjY2VwdGFuY2U6IGZhbHNlLAogICAgICAvLyDmlofku7bliJfooagKICAgICAgZmlsZUxpc3Q6IFtdLAogICAgICAvLyDkuIrkvKDlpLTpg6gKICAgICAgaGVhZGVyczogewogICAgICAgIEF1dGhvcml6YXRpb246ICdCZWFyZXIgJyArIGdldFRva2VuKCkKICAgICAgfQogICAgfTsKICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLnByb2plY3RJZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5wcm9qZWN0SWQ7CiAgICB0aGlzLnF1ZXJ5UGFyYW1zLnByb2plY3RJZCA9IHRoaXMucHJvamVjdElkOwogICAgdGhpcy5mb3JtLnByb2plY3RJZCA9IHRoaXMucHJvamVjdElkOwogICAgdGhpcy5nZXRQcm9qZWN0SW5mbygpOwogICAgdGhpcy5nZXRMaXN0KCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICAvLyDojrflj5bpobnnm67kv6Hmga8KICAgIGdldFByb2plY3RJbmZvKCkgewogICAgICBnZXRJbmZvKHRoaXMucHJvamVjdElkKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICB0aGlzLnByb2plY3RJbmZvID0gcmVzcG9uc2UuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g6I635Y+W6aqM5pS26K6w5b2V5YiX6KGoCiAgICBnZXRMaXN0KCkgewogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOwogICAgICBsaXN0UHJvamVjdEFjY2VwdGFuY2UodGhpcy5wcm9qZWN0SWQpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIHRoaXMuYWNjZXB0YW5jZUxpc3QgPSByZXNwb25zZS5yb3dzOwogICAgICAgIHRoaXMudG90YWwgPSByZXNwb25zZS50b3RhbDsKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g6KGo5Y2V5o+Q5LqkCiAgICBzdWJtaXRGb3JtKCkgewogICAgICB0aGlzLiRyZWZzWyJmb3JtIl0udmFsaWRhdGUodmFsaWQgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgYWRkQWNjZXB0YW5jZSh0aGlzLmZvcm0pLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICB0aGlzLiRtb2RhbC5tc2dTdWNjZXNzKCLmj5DkuqTmiJDlip8iKTsKICAgICAgICAgICAgdGhpcy5nZXRMaXN0KCk7CiAgICAgICAgICAgIC8vIOmHjee9ruihqOWNlQogICAgICAgICAgICB0aGlzLmZvcm0gPSB7CiAgICAgICAgICAgICAgcHJvamVjdElkOiB0aGlzLnByb2plY3RJZCwKICAgICAgICAgICAgICBhY2NlcHRhbmNlVGl0bGU6IHVuZGVmaW5lZCwKICAgICAgICAgICAgICBhY2NlcHRhbmNlQ29udGVudDogdW5kZWZpbmVkLAogICAgICAgICAgICAgIG1hdGVyaWFsc1BhdGg6IHVuZGVmaW5lZCwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgdGhpcy5maWxlTGlzdCA9IFtdOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICAvLyDmn6XnnIvpqozmlLbor6bmg4UKICAgIGhhbmRsZVZpZXcocm93KSB7CiAgICAgIHRoaXMucmVzZXQoKTsKICAgICAgdGhpcy5vcGVuID0gdHJ1ZTsKICAgICAgdGhpcy5pc0FjY2VwdGFuY2UgPSBmYWxzZTsKICAgICAgdGhpcy50aXRsZSA9ICLpqozmlLbor6bmg4UiOwoKICAgICAgZ2V0QWNjZXB0YW5jZShyb3cuaWQpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIHRoaXMudmlld0Zvcm0gPSByZXNwb25zZS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDov5vooYzpqozmlLYKICAgIGhhbmRsZUFjY2VwdGFuY2Uocm93KSB7CiAgICAgIHRoaXMucmVzZXQoKTsKICAgICAgdGhpcy5vcGVuID0gdHJ1ZTsKICAgICAgdGhpcy5pc0FjY2VwdGFuY2UgPSB0cnVlOwogICAgICB0aGlzLnRpdGxlID0gIumhueebrumqjOaUtiI7CgogICAgICBnZXRBY2NlcHRhbmNlKHJvdy5pZCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgdGhpcy52aWV3Rm9ybSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgdGhpcy5hY2NlcHRhbmNlRm9ybS5pZCA9IHJvdy5pZDsKICAgICAgfSk7CiAgICB9LAogICAgLy8g5o+Q5Lqk6aqM5pS257uT5p6cCiAgICBzdWJtaXRBY2NlcHRhbmNlKCkgewogICAgICB0aGlzLiRyZWZzWyJhY2NlcHRhbmNlRm9ybSJdLnZhbGlkYXRlKHZhbGlkID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIGNvbXBsZXRlQWNjZXB0YW5jZSh0aGlzLmFjY2VwdGFuY2VGb3JtKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgdGhpcy4kbW9kYWwubXNnU3VjY2Vzcygi6aqM5pS25a6M5oiQIik7CiAgICAgICAgICAgIHRoaXMub3BlbiA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLmdldExpc3QoKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgLy8g6YeN572u6KGo5Y2VCiAgICByZXNldCgpIHsKICAgICAgdGhpcy52aWV3Rm9ybSA9IHt9OwogICAgICB0aGlzLmFjY2VwdGFuY2VGb3JtID0gewogICAgICAgIGlkOiBudWxsLAogICAgICAgIHNjb3JlOiA1LAogICAgICAgIG9waW5pb246ICcnLAogICAgICAgIHN0YXR1czogJzEnCiAgICAgIH07CiAgICAgIHRoaXMuaXNBY2NlcHRhbmNlID0gZmFsc2U7CiAgICAgIHRoaXMucmVzZXRGb3JtKCJhY2NlcHRhbmNlRm9ybSIpOwogICAgfSwKICAgIC8vIOaWh+S7tuS4iuS8oOaIkOWKnwogICAgaGFuZGxlVXBsb2FkU3VjY2VzcyhyZXNwb25zZSwgZmlsZSwgZmlsZUxpc3QpIHsKICAgICAgdGhpcy5mb3JtLm1hdGVyaWFsc1BhdGggPSByZXNwb25zZS51cmw7CiAgICAgIHRoaXMuJG1vZGFsLm1zZ1N1Y2Nlc3MoIuS4iuS8oOaIkOWKnyIpOwogICAgfSwKICAgIC8vIOaWh+S7tuWIoOmZpAogICAgaGFuZGxlUmVtb3ZlKGZpbGUsIGZpbGVMaXN0KSB7CiAgICAgIHRoaXMuZm9ybS5tYXRlcmlhbHNQYXRoID0gJyc7CiAgICB9LAogICAgLy8g5paH5Lu26aKE6KeICiAgICBoYW5kbGVQcmV2aWV3KGZpbGUpIHsKICAgICAgd2luZG93Lm9wZW4oZmlsZS51cmwpOwogICAgfSwKICAgIC8vIOS4iuS8oOWJjeajgOafpQogICAgYmVmb3JlVXBsb2FkKGZpbGUpIHsKICAgICAgY29uc3QgaXNMdDEwTSA9IGZpbGUuc2l6ZSAvIDEwMjQgLyAxMDI0IDwgMTA7CiAgICAgIGlmICghaXNMdDEwTSkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+S4iuS8oOaWh+S7tuWkp+Wwj+S4jeiDvei2hei/hyAxME1CIScpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0sCiAgICAvLyDlj5bmtojmk43kvZwKICAgIGNhbmNlbCgpIHsKICAgICAgdGhpcy5vcGVuID0gZmFsc2U7CiAgICAgIHRoaXMucmVzZXQoKTsKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkJA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/project/acceptance","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-card class=\"box-card\">\n      <div slot=\"header\" class=\"clearfix\">\n        <span>项目验收申请</span>\n      </div>\n\n      <el-form ref=\"form\" :model=\"form\" :rules=\"rules\" label-width=\"120px\">\n        <el-form-item label=\"项目名称\">\n          <el-input v-model=\"projectInfo.projectName\" disabled />\n        </el-form-item>\n        <el-form-item label=\"验收标题\" prop=\"acceptanceTitle\">\n          <el-input v-model=\"form.acceptanceTitle\" placeholder=\"请输入验收标题\" />\n        </el-form-item>\n        <el-form-item label=\"验收内容\" prop=\"acceptanceContent\">\n          <el-input type=\"textarea\" v-model=\"form.acceptanceContent\" :rows=\"4\" placeholder=\"请输入验收内容\" />\n        </el-form-item>\n        <el-form-item label=\"验收材料\">\n          <el-upload\n            class=\"upload-demo\"\n            ref=\"upload\"\n            action=\"/api/common/upload\"\n            :on-preview=\"handlePreview\"\n            :on-remove=\"handleRemove\"\n            :on-success=\"handleUploadSuccess\"\n            :file-list=\"fileList\"\n            :headers=\"headers\"\n            :before-upload=\"beforeUpload\"\n            multiple>\n            <el-button size=\"small\" type=\"primary\">点击上传</el-button>\n            <div slot=\"tip\" class=\"el-upload__tip\">可上传验收相关文件，单个文件不超过10MB</div>\n          </el-upload>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"submitForm\">提交验收申请</el-button>\n          <el-button @click=\"cancel\">取消</el-button>\n        </el-form-item>\n      </el-form>\n    </el-card>\n\n    <!-- 验收记录列表 -->\n    <el-card class=\"box-card mt20\">\n      <div slot=\"header\" class=\"clearfix\">\n        <span>验收记录</span>\n      </div>\n\n      <el-table v-loading=\"loading\" :data=\"acceptanceList\">\n        <el-table-column label=\"验收编号\" align=\"center\" prop=\"acceptanceCode\" />\n        <el-table-column label=\"验收标题\" align=\"center\" prop=\"acceptanceTitle\" />\n        <el-table-column label=\"申请时间\" align=\"center\" prop=\"applyTime\" width=\"180\" />\n        <el-table-column label=\"验收时间\" align=\"center\" prop=\"acceptanceTime\" width=\"180\" />\n        <el-table-column label=\"验收人\" align=\"center\" prop=\"acceptanceUserName\" />\n        <el-table-column label=\"验收状态\" align=\"center\">\n          <template slot-scope=\"scope\">\n            <dict-tag :options=\"dict.type.acceptance_status\" :value=\"scope.row.status\"/>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"操作\" align=\"center\" class-name=\"small-padding fixed-width\">\n          <template slot-scope=\"scope\">\n            <el-button\n              size=\"mini\"\n              type=\"text\"\n              icon=\"el-icon-view\"\n              @click=\"handleView(scope.row)\"\n            >查看</el-button>\n            <el-button\n              size=\"mini\"\n              type=\"text\"\n              icon=\"el-icon-edit\"\n              @click=\"handleAcceptance(scope.row)\"\n              v-if=\"scope.row.status === '0' && checkPermission(['project:acceptance:approve'])\"\n            >验收</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <pagination\n        v-show=\"total>0\"\n        :total=\"total\"\n        :page.sync=\"queryParams.pageNum\"\n        :limit.sync=\"queryParams.pageSize\"\n        @pagination=\"getList\"\n      />\n    </el-card>\n\n    <!-- 验收详情对话框 -->\n    <el-dialog :title=\"title\" :visible.sync=\"open\" width=\"600px\" append-to-body>\n      <el-descriptions :column=\"2\" border>\n        <el-descriptions-item label=\"验收编号\">{{ viewForm.acceptanceCode }}</el-descriptions-item>\n        <el-descriptions-item label=\"验收标题\">{{ viewForm.acceptanceTitle }}</el-descriptions-item>\n        <el-descriptions-item label=\"申请时间\">{{ viewForm.applyTime }}</el-descriptions-item>\n        <el-descriptions-item label=\"验收状态\">\n          <dict-tag :options=\"dict.type.acceptance_status\" :value=\"viewForm.status\"/>\n        </el-descriptions-item>\n        <el-descriptions-item label=\"验收内容\" :span=\"2\">{{ viewForm.acceptanceContent }}</el-descriptions-item>\n        <el-descriptions-item label=\"验收材料\" :span=\"2\">\n          <el-link\n            v-if=\"viewForm.materialsPath\"\n            type=\"primary\"\n            :href=\"viewForm.materialsPath\"\n            target=\"_blank\"\n          >下载材料</el-link>\n          <span v-else>无</span>\n        </el-descriptions-item>\n        <el-descriptions-item label=\"验收评分\" v-if=\"viewForm.status !== '0'\">{{ viewForm.score }}</el-descriptions-item>\n        <el-descriptions-item label=\"验收人\" v-if=\"viewForm.status !== '0'\">{{ viewForm.acceptanceUserName }}</el-descriptions-item>\n        <el-descriptions-item label=\"验收意见\" :span=\"2\" v-if=\"viewForm.status !== '0'\">{{ viewForm.opinion }}</el-descriptions-item>\n      </el-descriptions>\n\n      <div v-if=\"isAcceptance\" class=\"mt20\">\n        <el-divider content-position=\"center\">验收结果</el-divider>\n        <el-form ref=\"acceptanceForm\" :model=\"acceptanceForm\" :rules=\"acceptanceRules\" label-width=\"100px\">\n          <el-form-item label=\"验收评分\" prop=\"score\">\n            <el-rate\n              v-model=\"acceptanceForm.score\"\n              :max=\"10\"\n              show-score\n              :colors=\"colors\"\n            ></el-rate>\n          </el-form-item>\n          <el-form-item label=\"验收意见\" prop=\"opinion\">\n            <el-input\n              type=\"textarea\"\n              v-model=\"acceptanceForm.opinion\"\n              :rows=\"3\"\n              placeholder=\"请输入验收意见\"\n            ></el-input>\n          </el-form-item>\n          <el-form-item label=\"验收结果\" prop=\"status\">\n            <el-radio-group v-model=\"acceptanceForm.status\">\n              <el-radio label=\"1\">通过</el-radio>\n              <el-radio label=\"2\">不通过</el-radio>\n            </el-radio-group>\n          </el-form-item>\n        </el-form>\n      </div>\n\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"open = false\">关 闭</el-button>\n        <el-button type=\"primary\" @click=\"submitAcceptance\" v-if=\"isAcceptance\">提 交</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\n// research-ui/src/views/project/acceptance/index.js\nimport { listProjectAcceptance, getAcceptance, addAcceptance, completeAcceptance } from \"@/api/project/acceptance\";\nimport { getInfo } from \"@/api/project/info\";\nimport { getToken } from \"@/utils/auth\";\n\nexport default {\n  name: \"ProjectAcceptance\",\n  dicts: ['acceptance_status'],\n  data() {\n    return {\n      // 遮罩层\n      loading: true,\n      // 项目ID\n      projectId: null,\n      // 项目信息\n      projectInfo: {},\n      // 查询参数\n      queryParams: {\n        pageNum: 1,\n        pageSize: 10,\n        projectId: undefined,\n      },\n      // 验收记录列表\n      acceptanceList: [],\n      // 总条数\n      total: 0,\n      // 验收表单\n      form: {\n        projectId: undefined,\n        acceptanceTitle: undefined,\n        acceptanceContent: undefined,\n        materialsPath: undefined,\n      },\n      // 验收详情表单\n      viewForm: {},\n      // 验收评审表单\n      acceptanceForm: {\n        id: null,\n        score: 5,\n        opinion: '',\n        status: '1'\n      },\n      // 表单校验\n      rules: {\n        acceptanceTitle: [\n          { required: true, message: \"验收标题不能为空\", trigger: \"blur\" }\n        ],\n        acceptanceContent: [\n          { required: true, message: \"验收内容不能为空\", trigger: \"blur\" }\n        ]\n      },\n      // 验收评审表单校验\n      acceptanceRules: {\n        score: [\n          { required: true, message: \"评分不能为空\", trigger: \"blur\" }\n        ],\n        opinion: [\n          { required: true, message: \"验收意见不能为空\", trigger: \"blur\" }\n        ],\n        status: [\n          { required: true, message: \"验收结果不能为空\", trigger: \"change\" }\n        ]\n      },\n      // 详情弹窗\n      open: false,\n      title: \"\",\n      isAcceptance: false,\n      // 文件列表\n      fileList: [],\n      // 上传头部\n      headers: {\n        Authorization: 'Bearer ' + getToken()\n      }\n    };\n  },\n  created() {\n    this.projectId = this.$route.params.projectId;\n    this.queryParams.projectId = this.projectId;\n    this.form.projectId = this.projectId;\n    this.getProjectInfo();\n    this.getList();\n  },\n  methods: {\n    // 获取项目信息\n    getProjectInfo() {\n      getInfo(this.projectId).then(response => {\n        this.projectInfo = response.data;\n      });\n    },\n    // 获取验收记录列表\n    getList() {\n      this.loading = true;\n      listProjectAcceptance(this.projectId).then(response => {\n        this.acceptanceList = response.rows;\n        this.total = response.total;\n        this.loading = false;\n      });\n    },\n    // 表单提交\n    submitForm() {\n      this.$refs[\"form\"].validate(valid => {\n        if (valid) {\n          addAcceptance(this.form).then(response => {\n            this.$modal.msgSuccess(\"提交成功\");\n            this.getList();\n            // 重置表单\n            this.form = {\n              projectId: this.projectId,\n              acceptanceTitle: undefined,\n              acceptanceContent: undefined,\n              materialsPath: undefined,\n            };\n            this.fileList = [];\n          });\n        }\n      });\n    },\n    // 查看验收详情\n    handleView(row) {\n      this.reset();\n      this.open = true;\n      this.isAcceptance = false;\n      this.title = \"验收详情\";\n\n      getAcceptance(row.id).then(response => {\n        this.viewForm = response.data;\n      });\n    },\n    // 进行验收\n    handleAcceptance(row) {\n      this.reset();\n      this.open = true;\n      this.isAcceptance = true;\n      this.title = \"项目验收\";\n\n      getAcceptance(row.id).then(response => {\n        this.viewForm = response.data;\n        this.acceptanceForm.id = row.id;\n      });\n    },\n    // 提交验收结果\n    submitAcceptance() {\n      this.$refs[\"acceptanceForm\"].validate(valid => {\n        if (valid) {\n          completeAcceptance(this.acceptanceForm).then(response => {\n            this.$modal.msgSuccess(\"验收完成\");\n            this.open = false;\n            this.getList();\n          });\n        }\n      });\n    },\n    // 重置表单\n    reset() {\n      this.viewForm = {};\n      this.acceptanceForm = {\n        id: null,\n        score: 5,\n        opinion: '',\n        status: '1'\n      };\n      this.isAcceptance = false;\n      this.resetForm(\"acceptanceForm\");\n    },\n    // 文件上传成功\n    handleUploadSuccess(response, file, fileList) {\n      this.form.materialsPath = response.url;\n      this.$modal.msgSuccess(\"上传成功\");\n    },\n    // 文件删除\n    handleRemove(file, fileList) {\n      this.form.materialsPath = '';\n    },\n    // 文件预览\n    handlePreview(file) {\n      window.open(file.url);\n    },\n    // 上传前检查\n    beforeUpload(file) {\n      const isLt10M = file.size / 1024 / 1024 < 10;\n      if (!isLt10M) {\n        this.$message.error('上传文件大小不能超过 10MB!');\n        return false;\n      }\n      return true;\n    },\n    // 取消操作\n    cancel() {\n      this.open = false;\n      this.reset();\n    }\n  }\n};\n</script>\n\n<style scoped>\n.mt20 {\n  margin-top: 20px;\n}\n</style>\n"]}]}