{"remainingRequest":"D:\\Code\\Research\\research-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Code\\Research\\research-ui\\src\\views\\project\\document\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\Code\\Research\\research-ui\\src\\views\\project\\document\\index.vue","mtime":1740901826726},{"path":"D:\\Code\\Research\\research-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1740793404454},{"path":"D:\\Code\\Research\\research-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1740793410952},{"path":"D:\\Code\\Research\\research-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1740793404454},{"path":"D:\\Code\\Research\\research-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1740793415933}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIHJlc2VhcmNoLXVpL3NyYy92aWV3cy9wcm9qZWN0L2RvY3VtZW50L2luZGV4LmpzCmltcG9ydCB7IGxpc3REb2N1bWVudCwgZ2V0RG9jdW1lbnQsIGFkZERvY3VtZW50LCB1cGRhdGVEb2N1bWVudCwgZGVsRG9jdW1lbnQgfSBmcm9tICJAL2FwaS9wcm9qZWN0L2RvY3VtZW50IjsKaW1wb3J0IHsgbGlzdEluZm9BbGwgfSBmcm9tICJAL2FwaS9wcm9qZWN0L2luZm8iOwppbXBvcnQgeyBnZXRUb2tlbiB9IGZyb20gIkAvdXRpbHMvYXV0aCI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkRvY3VtZW50IiwKICBkaWN0czogWydkb2N1bWVudF90eXBlJ10sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIC8vIOmBrue9qeWxggogICAgICBsb2FkaW5nOiB0cnVlLAogICAgICAvLyDpgInkuK3mlbDnu4QKICAgICAgaWRzOiBbXSwKICAgICAgLy8g6Z2e5Y2V5Liq56aB55SoCiAgICAgIHNpbmdsZTogdHJ1ZSwKICAgICAgLy8g6Z2e5aSa5Liq56aB55SoCiAgICAgIG11bHRpcGxlOiB0cnVlLAogICAgICAvLyDmmL7npLrmkJzntKLmnaHku7YKICAgICAgc2hvd1NlYXJjaDogdHJ1ZSwKICAgICAgLy8g5oC75p2h5pWwCiAgICAgIHRvdGFsOiAwLAogICAgICAvLyDpobnnm67moaPmoYjooajmoLzmlbDmja4KICAgICAgZG9jdW1lbnRMaXN0OiBbXSwKICAgICAgLy8g5by55Ye65bGC5qCH6aKYCiAgICAgIHRpdGxlOiAiIiwKICAgICAgLy8g5piv5ZCm5pi+56S65by55Ye65bGCCiAgICAgIG9wZW46IGZhbHNlLAogICAgICAvLyDmn6Xor6Llj4LmlbAKICAgICAgcXVlcnlQYXJhbXM6IHsKICAgICAgICBwYWdlTnVtOiAxLAogICAgICAgIHBhZ2VTaXplOiAxMCwKICAgICAgICBwcm9qZWN0SWQ6IG51bGwsCiAgICAgICAgZG9jdW1lbnROYW1lOiBudWxsLAogICAgICAgIGRvY3VtZW50VHlwZTogbnVsbAogICAgICB9LAogICAgICAvLyDooajljZXlj4LmlbAKICAgICAgZm9ybTogewogICAgICAgIGlkOiBudWxsLAogICAgICAgIHByb2plY3RJZDogbnVsbCwKICAgICAgICBkb2N1bWVudE5hbWU6IG51bGwsCiAgICAgICAgZG9jdW1lbnRUeXBlOiBudWxsLAogICAgICAgIGZpbGVQYXRoOiBudWxsCiAgICAgIH0sCiAgICAgIC8vIOihqOWNleagoemqjAogICAgICBydWxlczogewogICAgICAgIHByb2plY3RJZDogWwogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIumhueebruS4jeiDveS4uuepuiIsIHRyaWdnZXI6ICJjaGFuZ2UiIH0KICAgICAgICBdLAogICAgICAgIGRvY3VtZW50TmFtZTogWwogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuaWh+aho+WQjeensOS4jeiDveS4uuepuiIsIHRyaWdnZXI6ICJibHVyIiB9CiAgICAgICAgXSwKICAgICAgICBkb2N1bWVudFR5cGU6IFsKICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICLmlofmoaPnsbvlnovkuI3og73kuLrnqboiLCB0cmlnZ2VyOiAiY2hhbmdlIiB9CiAgICAgICAgXQogICAgICB9LAogICAgICAvLyDpobnnm67pgInpobkKICAgICAgcHJvamVjdE9wdGlvbnM6IFtdLAogICAgICAvLyDmlofku7bliJfooagKICAgICAgZmlsZUxpc3Q6IFtdLAogICAgICAvLyDkuIrkvKDlpLTpg6gKICAgICAgaGVhZGVyczogewogICAgICAgIEF1dGhvcml6YXRpb246ICdCZWFyZXIgJyArIGdldFRva2VuKCkKICAgICAgfQogICAgfTsKICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldExpc3QoKTsKICAgIHRoaXMuZ2V0UHJvamVjdE9wdGlvbnMoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOiOt+WPlumhueebruaho+ahiOWIl+ihqAogICAgZ2V0TGlzdCgpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgbGlzdERvY3VtZW50KHRoaXMucXVlcnlQYXJhbXMpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIHRoaXMuZG9jdW1lbnRMaXN0ID0gcmVzcG9uc2Uucm93czsKICAgICAgICB0aGlzLnRvdGFsID0gcmVzcG9uc2UudG90YWw7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOiOt+WPlumhueebrumAiemhuQogICAgZ2V0UHJvamVjdE9wdGlvbnMoKSB7CiAgICAgIGxpc3RJbmZvQWxsKCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgdGhpcy5wcm9qZWN0T3B0aW9ucyA9IHJlc3BvbnNlLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOagvOW8j+WMluaWh+S7tuWkp+WwjwogICAgZm9ybWF0RmlsZVNpemUoc2l6ZSkgewogICAgICBpZiAoc2l6ZSA8IDEwMjQpIHsKICAgICAgICByZXR1cm4gc2l6ZSArICcgQic7CiAgICAgIH0gZWxzZSBpZiAoc2l6ZSA8IDEwMjQgKiAxMDI0KSB7CiAgICAgICAgcmV0dXJuIChzaXplIC8gMTAyNCkudG9GaXhlZCgyKSArICcgS0InOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAoc2l6ZSAvIDEwMjQgLyAxMDI0KS50b0ZpeGVkKDIpICsgJyBNQic7CiAgICAgIH0KICAgIH0sCiAgICAvLyDliKTmlq3mmK/lkKblj6/pooTop4jmlofku7YKICAgIGlzUHJldmlld2FibGUoZmlsZU5hbWUpIHsKICAgICAgaWYgKCFmaWxlTmFtZSkgcmV0dXJuIGZhbHNlOwogICAgICBjb25zdCBzdWZmaXggPSBmaWxlTmFtZS5zdWJzdHJpbmcoZmlsZU5hbWUubGFzdEluZGV4T2YoJy4nKSArIDEpLnRvTG93ZXJDYXNlKCk7CiAgICAgIHJldHVybiBbJ2pwZycsICdqcGVnJywgJ3BuZycsICdnaWYnLCAnYm1wJywgJ3BkZicsICd0eHQnLCAnZG9jJywgJ2RvY3gnLCAneGxzJywgJ3hsc3gnLCAncHB0JywgJ3BwdHgnXS5pbmRleE9mKHN1ZmZpeCkgIT09IC0xOwogICAgfSwKICAgIC8vIOWPlua2iOaMiemSrgogICAgY2FuY2VsKCkgewogICAgICB0aGlzLm9wZW4gPSBmYWxzZTsKICAgICAgdGhpcy5yZXNldCgpOwogICAgfSwKICAgIC8vIOihqOWNlemHjee9rgogICAgcmVzZXQoKSB7CiAgICAgIHRoaXMuZm9ybSA9IHsKICAgICAgICBpZDogbnVsbCwKICAgICAgICBwcm9qZWN0SWQ6IG51bGwsCiAgICAgICAgZG9jdW1lbnROYW1lOiBudWxsLAogICAgICAgIGRvY3VtZW50VHlwZTogbnVsbCwKICAgICAgICBmaWxlUGF0aDogbnVsbAogICAgICB9OwogICAgICB0aGlzLmZpbGVMaXN0ID0gW107CiAgICAgIHRoaXMucmVzZXRGb3JtKCJmb3JtIik7CiAgICB9LAogICAgLy8g5pCc57Si5oyJ6ZKu5pON5L2cCiAgICBoYW5kbGVRdWVyeSgpIHsKICAgICAgdGhpcy5xdWVyeVBhcmFtcy5wYWdlTnVtID0gMTsKICAgICAgdGhpcy5nZXRMaXN0KCk7CiAgICB9LAogICAgLy8g6YeN572u5oyJ6ZKu5pON5L2cCiAgICByZXNldFF1ZXJ5KCkgewogICAgICB0aGlzLnJlc2V0Rm9ybSgicXVlcnlGb3JtIik7CiAgICAgIHRoaXMuaGFuZGxlUXVlcnkoKTsKICAgIH0sCiAgICAvLyDlpJrpgInmoYbpgInkuK3mlbDmja4KICAgIGhhbmRsZVNlbGVjdGlvbkNoYW5nZShzZWxlY3Rpb24pIHsKICAgICAgdGhpcy5pZHMgPSBzZWxlY3Rpb24ubWFwKGl0ZW0gPT4gaXRlbS5pZCkKICAgICAgdGhpcy5zaW5nbGUgPSBzZWxlY3Rpb24ubGVuZ3RoIT09MQogICAgICB0aGlzLm11bHRpcGxlID0gIXNlbGVjdGlvbi5sZW5ndGgKICAgIH0sCiAgICAvLyDmlrDlop7mjInpkq7mk43kvZwKICAgIGhhbmRsZUFkZCgpIHsKICAgICAgdGhpcy5yZXNldCgpOwogICAgICB0aGlzLm9wZW4gPSB0cnVlOwogICAgICB0aGlzLnRpdGxlID0gIua3u+WKoOmhueebruaho+ahiCI7CiAgICB9LAogICAgLy8g5Yig6Zmk5oyJ6ZKu5pON5L2cCiAgICBoYW5kbGVEZWxldGUocm93KSB7CiAgICAgIGNvbnN0IGlkcyA9IHJvdy5pZCB8fCB0aGlzLmlkczsKICAgICAgdGhpcy4kbW9kYWwuY29uZmlybSgn5piv5ZCm56Gu6K6k5Yig6Zmk6aG555uu5qGj5qGI57yW5Y+35Li6IicgKyBpZHMgKyAnIueahOaVsOaNrumhue+8nycpLnRoZW4oKCkgPT4gewogICAgICAgIHJldHVybiBkZWxEb2N1bWVudChpZHMpOwogICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICB0aGlzLmdldExpc3QoKTsKICAgICAgICB0aGlzLiRtb2RhbC5tc2dTdWNjZXNzKCLliKDpmaTmiJDlip8iKTsKICAgICAgfSkuY2F0Y2goKCkgPT4ge30pOwogICAgfSwKICAgIC8vIOS4i+i9veaWh+S7tgogICAgaGFuZGxlRG93bmxvYWQocm93KSB7CiAgICAgIHdpbmRvdy5vcGVuKHJvdy5maWxlUGF0aCk7CiAgICB9LAogICAgLy8g6aKE6KeI5paH5Lu2CiAgICBoYW5kbGVQcmV2aWV3KHJvdykgewogICAgICBjb25zdCB1cmwgPSB0eXBlb2Ygcm93ID09PSAnb2JqZWN0JyA/IHJvdy5maWxlUGF0aCB8fCByb3cudXJsIDogcm93OwogICAgICB3aW5kb3cub3Blbih1cmwpOwogICAgfSwKICAgIC8vIOS4iuS8oOaIkOWKn+WbnuiwgwogICAgaGFuZGxlVXBsb2FkU3VjY2VzcyhyZXNwb25zZSwgZmlsZSwgZmlsZUxpc3QpIHsKICAgICAgdGhpcy5mb3JtLmZpbGVQYXRoID0gcmVzcG9uc2UudXJsOwogICAgICB0aGlzLmZvcm0uZmlsZVNpemUgPSBmaWxlLnNpemU7CiAgICAgIHRoaXMuJG1vZGFsLm1zZ1N1Y2Nlc3MoIuS4iuS8oOaIkOWKnyIpOwogICAgfSwKICAgIC8vIOenu+mZpOaWh+S7tgogICAgaGFuZGxlUmVtb3ZlKGZpbGUsIGZpbGVMaXN0KSB7CiAgICAgIHRoaXMuZm9ybS5maWxlUGF0aCA9ICcnOwogICAgICB0aGlzLmZvcm0uZmlsZVNpemUgPSAwOwogICAgfSwKICAgIC8vIOS4iuS8oOWJjeagoemqjAogICAgYmVmb3JlVXBsb2FkKGZpbGUpIHsKICAgICAgY29uc3QgaXNMdDIwTSA9IGZpbGUuc2l6ZSAvIDEwMjQgLyAxMDI0IDwgMjA7CiAgICAgIGlmICghaXNMdDIwTSkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+S4iuS8oOaWh+S7tuWkp+Wwj+S4jeiDvei2hei/hyAyME1CIScpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0sCiAgICAvLyDmj5DkuqTooajljZUKICAgIHN1Ym1pdEZvcm0oKSB7CiAgICAgIHRoaXMuJHJlZnNbImZvcm0iXS52YWxpZGF0ZSh2YWxpZCA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBpZiAoIXRoaXMuZm9ybS5maWxlUGF0aCkgewogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfor7fkuIrkvKDmlofku7YnKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0aGlzLmZvcm0uaWQgIT0gbnVsbCkgewogICAgICAgICAgICB1cGRhdGVEb2N1bWVudCh0aGlzLmZvcm0pLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgIHRoaXMuJG1vZGFsLm1zZ1N1Y2Nlc3MoIuS/ruaUueaIkOWKnyIpOwogICAgICAgICAgICAgIHRoaXMub3BlbiA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMuZ2V0TGlzdCgpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFkZERvY3VtZW50KHRoaXMuZm9ybSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgdGhpcy4kbW9kYWwubXNnU3VjY2Vzcygi5paw5aKe5oiQ5YqfIik7CiAgICAgICAgICAgICAgdGhpcy5vcGVuID0gZmFsc2U7CiAgICAgICAgICAgICAgdGhpcy5nZXRMaXN0KCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmKA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/project/document","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-form :model=\"queryParams\" ref=\"queryForm\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\n      <el-form-item label=\"项目名称\" prop=\"projectId\">\n        <el-select v-model=\"queryParams.projectId\" placeholder=\"请选择项目\" clearable>\n          <el-option\n            v-for=\"item in projectOptions\"\n            :key=\"item.id\"\n            :label=\"item.projectName\"\n            :value=\"item.id\"\n          />\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"文档名称\" prop=\"documentName\">\n        <el-input\n          v-model=\"queryParams.documentName\"\n          placeholder=\"请输入文档名称\"\n          clearable\n          style=\"width: 240px\"\n          @keyup.enter.native=\"handleQuery\"\n        />\n      </el-form-item>\n      <el-form-item label=\"文档类型\" prop=\"documentType\">\n        <el-select v-model=\"queryParams.documentType\" placeholder=\"请选择文档类型\" clearable>\n          <el-option\n            v-for=\"dict in dict.type.document_type\"\n            :key=\"dict.value\"\n            :label=\"dict.label\"\n            :value=\"dict.value\"\n          />\n        </el-select>\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"handleQuery\">搜索</el-button>\n        <el-button icon=\"el-icon-refresh\" @click=\"resetQuery\">重置</el-button>\n      </el-form-item>\n    </el-form>\n\n    <el-row :gutter=\"10\" class=\"mb8\">\n      <el-col :span=\"1.5\">\n        <el-button\n          type=\"primary\"\n          plain\n          icon=\"el-icon-plus\"\n          @click=\"handleAdd\"\n          v-hasPermi=\"['project:document:add']\"\n        >新增</el-button>\n      </el-col>\n      <el-col :span=\"1.5\">\n        <el-button\n          type=\"danger\"\n          plain\n          icon=\"el-icon-delete\"\n          :disabled=\"multiple\"\n          @click=\"handleDelete\"\n          v-hasPermi=\"['project:document:remove']\"\n        >删除</el-button>\n      </el-col>\n      <right-toolbar :showSearch.sync=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\n    </el-row>\n\n    <el-table v-loading=\"loading\" :data=\"documentList\" @selection-change=\"handleSelectionChange\">\n      <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\n      <el-table-column label=\"文档编号\" align=\"center\" prop=\"documentCode\" />\n      <el-table-column label=\"文档名称\" align=\"center\" prop=\"documentName\" />\n      <el-table-column label=\"项目名称\" align=\"center\" prop=\"projectName\" />\n      <el-table-column label=\"文档类型\" align=\"center\" prop=\"documentType\">\n        <template slot-scope=\"scope\">\n          <dict-tag :options=\"dict.type.document_type\" :value=\"scope.row.documentType\"/>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"文件大小\" align=\"center\" prop=\"fileSize\">\n        <template slot-scope=\"scope\">\n          {{ formatFileSize(scope.row.fileSize) }}\n        </template>\n      </el-table-column>\n      <el-table-column label=\"上传时间\" align=\"center\" prop=\"uploadTime\" width=\"180\" />\n      <el-table-column label=\"上传人\" align=\"center\" prop=\"uploadUserName\" />\n      <el-table-column label=\"操作\" align=\"center\" class-name=\"small-padding fixed-width\">\n        <template slot-scope=\"scope\">\n          <el-button\n            size=\"mini\"\n            type=\"text\"\n            icon=\"el-icon-download\"\n            @click=\"handleDownload(scope.row)\"\n          >下载</el-button>\n          <el-button\n            size=\"mini\"\n            type=\"text\"\n            icon=\"el-icon-view\"\n            @click=\"handlePreview(scope.row)\"\n            v-if=\"isPreviewable(scope.row.documentName)\"\n          >预览</el-button>\n          <el-button\n            size=\"mini\"\n            type=\"text\"\n            icon=\"el-icon-delete\"\n            @click=\"handleDelete(scope.row)\"\n            v-hasPermi=\"['project:document:remove']\"\n          >删除</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <pagination\n      v-show=\"total>0\"\n      :total=\"total\"\n      :page.sync=\"queryParams.pageNum\"\n      :limit.sync=\"queryParams.pageSize\"\n      @pagination=\"getList\"\n    />\n\n    <!-- 添加文档对话框 -->\n    <el-dialog :title=\"title\" :visible.sync=\"open\" width=\"500px\" append-to-body>\n      <el-form ref=\"form\" :model=\"form\" :rules=\"rules\" label-width=\"100px\">\n        <el-form-item label=\"项目\" prop=\"projectId\">\n          <el-select v-model=\"form.projectId\" placeholder=\"请选择项目\">\n            <el-option\n              v-for=\"item in projectOptions\"\n              :key=\"item.id\"\n              :label=\"item.projectName\"\n              :value=\"item.id\"\n            />\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"文档名称\" prop=\"documentName\">\n          <el-input v-model=\"form.documentName\" placeholder=\"请输入文档名称\" />\n        </el-form-item>\n        <el-form-item label=\"文档类型\" prop=\"documentType\">\n          <el-select v-model=\"form.documentType\" placeholder=\"请选择文档类型\">\n            <el-option\n              v-for=\"dict in dict.type.document_type\"\n              :key=\"dict.value\"\n              :label=\"dict.label\"\n              :value=\"dict.value\"\n            />\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"文档文件\" prop=\"filePath\">\n          <el-upload\n            class=\"upload-demo\"\n            ref=\"upload\"\n            action=\"/api/common/upload\"\n            :on-preview=\"handlePreview\"\n            :on-remove=\"handleRemove\"\n            :on-success=\"handleUploadSuccess\"\n            :file-list=\"fileList\"\n            :headers=\"headers\"\n            :before-upload=\"beforeUpload\">\n            <el-button type=\"primary\">点击上传</el-button>\n            <div slot=\"tip\" class=\"el-upload__tip\">请上传文档文件，单个文件不超过20MB</div>\n          </el-upload>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button type=\"primary\" @click=\"submitForm\">确 定</el-button>\n        <el-button @click=\"cancel\">取 消</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\n// research-ui/src/views/project/document/index.js\nimport { listDocument, getDocument, addDocument, updateDocument, delDocument } from \"@/api/project/document\";\nimport { listInfoAll } from \"@/api/project/info\";\nimport { getToken } from \"@/utils/auth\";\n\nexport default {\n  name: \"Document\",\n  dicts: ['document_type'],\n  data() {\n    return {\n      // 遮罩层\n      loading: true,\n      // 选中数组\n      ids: [],\n      // 非单个禁用\n      single: true,\n      // 非多个禁用\n      multiple: true,\n      // 显示搜索条件\n      showSearch: true,\n      // 总条数\n      total: 0,\n      // 项目档案表格数据\n      documentList: [],\n      // 弹出层标题\n      title: \"\",\n      // 是否显示弹出层\n      open: false,\n      // 查询参数\n      queryParams: {\n        pageNum: 1,\n        pageSize: 10,\n        projectId: null,\n        documentName: null,\n        documentType: null\n      },\n      // 表单参数\n      form: {\n        id: null,\n        projectId: null,\n        documentName: null,\n        documentType: null,\n        filePath: null\n      },\n      // 表单校验\n      rules: {\n        projectId: [\n          { required: true, message: \"项目不能为空\", trigger: \"change\" }\n        ],\n        documentName: [\n          { required: true, message: \"文档名称不能为空\", trigger: \"blur\" }\n        ],\n        documentType: [\n          { required: true, message: \"文档类型不能为空\", trigger: \"change\" }\n        ]\n      },\n      // 项目选项\n      projectOptions: [],\n      // 文件列表\n      fileList: [],\n      // 上传头部\n      headers: {\n        Authorization: 'Bearer ' + getToken()\n      }\n    };\n  },\n  created() {\n    this.getList();\n    this.getProjectOptions();\n  },\n  methods: {\n    // 获取项目档案列表\n    getList() {\n      this.loading = true;\n      listDocument(this.queryParams).then(response => {\n        this.documentList = response.rows;\n        this.total = response.total;\n        this.loading = false;\n      });\n    },\n    // 获取项目选项\n    getProjectOptions() {\n      listInfoAll().then(response => {\n        this.projectOptions = response.data;\n      });\n    },\n    // 格式化文件大小\n    formatFileSize(size) {\n      if (size < 1024) {\n        return size + ' B';\n      } else if (size < 1024 * 1024) {\n        return (size / 1024).toFixed(2) + ' KB';\n      } else {\n        return (size / 1024 / 1024).toFixed(2) + ' MB';\n      }\n    },\n    // 判断是否可预览文件\n    isPreviewable(fileName) {\n      if (!fileName) return false;\n      const suffix = fileName.substring(fileName.lastIndexOf('.') + 1).toLowerCase();\n      return ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'pdf', 'txt', 'doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx'].indexOf(suffix) !== -1;\n    },\n    // 取消按钮\n    cancel() {\n      this.open = false;\n      this.reset();\n    },\n    // 表单重置\n    reset() {\n      this.form = {\n        id: null,\n        projectId: null,\n        documentName: null,\n        documentType: null,\n        filePath: null\n      };\n      this.fileList = [];\n      this.resetForm(\"form\");\n    },\n    // 搜索按钮操作\n    handleQuery() {\n      this.queryParams.pageNum = 1;\n      this.getList();\n    },\n    // 重置按钮操作\n    resetQuery() {\n      this.resetForm(\"queryForm\");\n      this.handleQuery();\n    },\n    // 多选框选中数据\n    handleSelectionChange(selection) {\n      this.ids = selection.map(item => item.id)\n      this.single = selection.length!==1\n      this.multiple = !selection.length\n    },\n    // 新增按钮操作\n    handleAdd() {\n      this.reset();\n      this.open = true;\n      this.title = \"添加项目档案\";\n    },\n    // 删除按钮操作\n    handleDelete(row) {\n      const ids = row.id || this.ids;\n      this.$modal.confirm('是否确认删除项目档案编号为\"' + ids + '\"的数据项？').then(() => {\n        return delDocument(ids);\n      }).then(() => {\n        this.getList();\n        this.$modal.msgSuccess(\"删除成功\");\n      }).catch(() => {});\n    },\n    // 下载文件\n    handleDownload(row) {\n      window.open(row.filePath);\n    },\n    // 预览文件\n    handlePreview(row) {\n      const url = typeof row === 'object' ? row.filePath || row.url : row;\n      window.open(url);\n    },\n    // 上传成功回调\n    handleUploadSuccess(response, file, fileList) {\n      this.form.filePath = response.url;\n      this.form.fileSize = file.size;\n      this.$modal.msgSuccess(\"上传成功\");\n    },\n    // 移除文件\n    handleRemove(file, fileList) {\n      this.form.filePath = '';\n      this.form.fileSize = 0;\n    },\n    // 上传前校验\n    beforeUpload(file) {\n      const isLt20M = file.size / 1024 / 1024 < 20;\n      if (!isLt20M) {\n        this.$message.error('上传文件大小不能超过 20MB!');\n        return false;\n      }\n      return true;\n    },\n    // 提交表单\n    submitForm() {\n      this.$refs[\"form\"].validate(valid => {\n        if (valid) {\n          if (!this.form.filePath) {\n            this.$message.error('请上传文件');\n            return;\n          }\n\n          if (this.form.id != null) {\n            updateDocument(this.form).then(response => {\n              this.$modal.msgSuccess(\"修改成功\");\n              this.open = false;\n              this.getList();\n            });\n          } else {\n            addDocument(this.form).then(response => {\n              this.$modal.msgSuccess(\"新增成功\");\n              this.open = false;\n              this.getList();\n            });\n          }\n        }\n      });\n    }\n  }\n};\n</script>\n"]}]}