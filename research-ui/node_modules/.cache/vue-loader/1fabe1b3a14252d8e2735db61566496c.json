{"remainingRequest":"D:\\Code\\Research\\research-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Code\\Research\\research-ui\\src\\views\\project\\process\\index.vue?vue&type=style&index=0&id=37335912&scoped=true&lang=css","dependencies":[{"path":"D:\\Code\\Research\\research-ui\\src\\views\\project\\process\\index.vue","mtime":1740901687801},{"path":"D:\\Code\\Research\\research-ui\\node_modules\\css-loader\\dist\\cjs.js","mtime":1740793408139},{"path":"D:\\Code\\Research\\research-ui\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1740793417979},{"path":"D:\\Code\\Research\\research-ui\\node_modules\\postcss-loader\\src\\index.js","mtime":1740793410952},{"path":"D:\\Code\\Research\\research-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1740793404454},{"path":"D:\\Code\\Research\\research-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1740793415933}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLm1pbGVzdG9uZS1hY3Rpb25zIHsKICBtYXJnaW4tdG9wOiAxMHB4OwogIHRleHQtYWxpZ246IHJpZ2h0Owp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgSA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/project/process","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-card class=\"box-card\">\n      <div slot=\"header\" class=\"clearfix\">\n        <span>项目基本信息</span>\n      </div>\n      <el-descriptions :column=\"3\" border>\n        <el-descriptions-item label=\"项目名称\">{{ projectInfo.projectName }}</el-descriptions-item>\n        <el-descriptions-item label=\"项目编号\">{{ projectInfo.projectCode }}</el-descriptions-item>\n        <el-descriptions-item label=\"项目类型\">\n          <dict-tag :options=\"dict.type.project_type\" :value=\"projectInfo.projectType\"/>\n        </el-descriptions-item>\n        <el-descriptions-item label=\"开始日期\">{{ projectInfo.startDate }}</el-descriptions-item>\n        <el-descriptions-item label=\"结束日期\">{{ projectInfo.endDate }}</el-descriptions-item>\n        <el-descriptions-item label=\"项目状态\">\n          <dict-tag :options=\"dict.type.project_status\" :value=\"projectInfo.status\"/>\n        </el-descriptions-item>\n      </el-descriptions>\n    </el-card>\n\n    <el-card class=\"box-card\" style=\"margin-top: 15px\">\n      <div slot=\"header\" class=\"clearfix\">\n        <span>项目进度</span>\n        <el-button\n          style=\"float: right; padding: 3px 0\"\n          type=\"text\"\n          icon=\"el-icon-plus\"\n          @click=\"handleAddMilestone\"\n        >添加里程碑</el-button>\n      </div>\n\n      <el-progress :percentage=\"totalProgress\" :format=\"progressFormat\"></el-progress>\n\n      <el-timeline style=\"margin-top: 20px\">\n        <el-timeline-item\n          v-for=\"(milestone, index) in milestones\"\n          :key=\"index\"\n          :timestamp=\"milestone.planEndDate\"\n          :type=\"getTimelineItemType(milestone.status)\"\n        >\n          <el-card>\n            <h4>{{ milestone.milestoneName }}</h4>\n            <p>计划时间: {{ milestone.planStartDate }} 至 {{ milestone.planEndDate }}</p>\n            <p>负责人: {{ milestone.leaderUserName }}</p>\n            <p>进度: {{ milestone.progressRate }}%</p>\n            <p>状态:\n              <dict-tag :options=\"dict.type.milestone_status\" :value=\"milestone.status\"/>\n            </p>\n            <div class=\"milestone-actions\">\n              <el-button\n                size=\"mini\"\n                type=\"primary\"\n                icon=\"el-icon-edit\"\n                @click=\"handleEditMilestone(milestone)\"\n              >编辑</el-button>\n              <el-button\n                size=\"mini\"\n                type=\"danger\"\n                icon=\"el-icon-delete\"\n                @click=\"handleDeleteMilestone(milestone)\"\n              >删除</el-button>\n            </div>\n          </el-card>\n        </el-timeline-item>\n      </el-timeline>\n    </el-card>\n\n    <!-- 里程碑编辑对话框 -->\n    <el-dialog :title=\"title\" :visible.sync=\"open\" width=\"500px\" append-to-body>\n      <el-form ref=\"form\" :model=\"form\" :rules=\"rules\" label-width=\"120px\">\n        <el-form-item label=\"里程碑名称\" prop=\"milestoneName\">\n          <el-input v-model=\"form.milestoneName\" placeholder=\"请输入里程碑名称\" />\n        </el-form-item>\n        <el-form-item label=\"计划开始时间\" prop=\"planStartDate\">\n          <el-date-picker\n            v-model=\"form.planStartDate\"\n            type=\"date\"\n            placeholder=\"选择日期\"\n            value-format=\"yyyy-MM-dd\"\n          />\n        </el-form-item>\n        <el-form-item label=\"计划结束时间\" prop=\"planEndDate\">\n          <el-date-picker\n            v-model=\"form.planEndDate\"\n            type=\"date\"\n            placeholder=\"选择日期\"\n            value-format=\"yyyy-MM-dd\"\n          />\n        </el-form-item>\n        <el-form-item label=\"负责人\" prop=\"leaderUserId\">\n          <el-select v-model=\"form.leaderUserId\" placeholder=\"请选择负责人\">\n            <el-option\n              v-for=\"user in userOptions\"\n              :key=\"user.userId\"\n              :label=\"user.userName\"\n              :value=\"user.userId\"\n            />\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"进度百分比\" prop=\"progressRate\">\n          <el-slider v-model=\"form.progressRate\" :format-tooltip=\"formatTooltip\"></el-slider>\n        </el-form-item>\n        <el-form-item label=\"状态\" prop=\"status\">\n          <el-select v-model=\"form.status\" placeholder=\"请选择状态\">\n            <el-option\n              v-for=\"dict in dict.type.milestone_status\"\n              :key=\"dict.value\"\n              :label=\"dict.label\"\n              :value=\"dict.value\"\n            />\n          </el-select>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button type=\"primary\" @click=\"submitForm\">确 定</el-button>\n        <el-button @click=\"cancel\">取 消</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\n// research-ui/src/views/project/progress/index.js\nimport { listProjectMilestones, addMilestone, updateMilestone, deleteMilestone, getProjectProgressSummary } from \"@/api/project/progress\";\nimport { getInfo } from \"@/api/project/info\";\n\nexport default {\n  name: \"ProjectProgress\",\n  dicts: ['milestone_status'],\n  data() {\n    return {\n      // 遮罩层\n      loading: true,\n      // 项目ID\n      projectId: null,\n      // 项目信息\n      projectInfo: {},\n      // 里程碑列表\n      milestones: [],\n      // 总进度\n      totalProgress: 0,\n      // 弹出层标题\n      title: \"\",\n      // 是否显示弹出层\n      open: false,\n      // 表单参数\n      form: {\n        id: undefined,\n        projectId: undefined,\n        milestoneName: undefined,\n        planStartDate: undefined,\n        planEndDate: undefined,\n        actualStartDate: undefined,\n        actualEndDate: undefined,\n        progressRate: 0,\n        leaderUserId: undefined,\n        status: \"0\"\n      },\n      // 表单校验\n      rules: {\n        milestoneName: [\n          { required: true, message: \"里程碑名称不能为空\", trigger: \"blur\" }\n        ],\n        planStartDate: [\n          { required: true, message: \"计划开始日期不能为空\", trigger: \"change\" }\n        ],\n        planEndDate: [\n          { required: true, message: \"计划结束日期不能为空\", trigger: \"change\" }\n        ],\n        progressRate: [\n          { required: true, message: \"进度百分比不能为空\", trigger: \"blur\" }\n        ],\n        leaderUserId: [\n          { required: true, message: \"负责人不能为空\", trigger: \"blur\" }\n        ]\n      }\n    };\n  },\n  created() {\n    this.projectId = this.$route.params.projectId;\n    this.getProjectInfo();\n    this.getMilestones();\n  },\n  methods: {\n    // 获取项目信息\n    getProjectInfo() {\n      getInfo(this.projectId).then(response => {\n        this.projectInfo = response.data;\n      });\n    },\n    // 获取项目里程碑列表\n    getMilestones() {\n      this.loading = true;\n      listProjectMilestones(this.projectId).then(response => {\n        this.milestones = response.data;\n        this.loading = false;\n        this.getProgressSummary();\n      });\n    },\n    // 获取项目进度统计\n    getProgressSummary() {\n      getProjectProgressSummary(this.projectId).then(response => {\n        this.totalProgress = response.data.progressRate || 0;\n      });\n    },\n    // 进度格式化\n    progressFormat(percentage) {\n      return percentage + '%';\n    },\n    // 获取时间线项类型\n    getTimelineItemType(status) {\n      const statusMap = {\n        '0': 'info',    // 未开始\n        '1': 'primary', // 进行中\n        '2': 'success', // 已完成\n        '3': 'danger'   // 已延期\n      };\n      return statusMap[status] || 'info';\n    },\n    // 添加里程碑\n    handleAddMilestone() {\n      this.reset();\n      this.open = true;\n      this.title = \"添加里程碑\";\n      this.form.projectId = this.projectId;\n    },\n    // 编辑里程碑\n    handleEditMilestone(milestone) {\n      this.reset();\n      this.open = true;\n      this.title = \"编辑里程碑\";\n      this.form = JSON.parse(JSON.stringify(milestone));\n    },\n    // 删除里程碑\n    handleDeleteMilestone(milestone) {\n      this.$modal.confirm('是否确认删除该里程碑?').then(() => {\n        deleteMilestone(milestone.id).then(() => {\n          this.$modal.msgSuccess(\"删除成功\");\n          this.getMilestones();\n        });\n      }).catch(() => {});\n    },\n    // 表单重置\n    reset() {\n      this.form = {\n        id: undefined,\n        projectId: this.projectId,\n        milestoneName: undefined,\n        planStartDate: undefined,\n        planEndDate: undefined,\n        actualStartDate: undefined,\n        actualEndDate: undefined,\n        progressRate: 0,\n        leaderUserId: undefined,\n        status: \"0\"\n      };\n      this.resetForm(\"form\");\n    },\n    // 取消按钮\n    cancel() {\n      this.open = false;\n      this.reset();\n    },\n    // 提交按钮\n    submitForm() {\n      this.$refs[\"form\"].validate(valid => {\n        if (valid) {\n          if (this.form.id !== undefined) {\n            updateMilestone(this.form).then(response => {\n              this.$modal.msgSuccess(\"修改成功\");\n              this.open = false;\n              this.getMilestones();\n            });\n          } else {\n            addMilestone(this.form).then(response => {\n              this.$modal.msgSuccess(\"新增成功\");\n              this.open = false;\n              this.getMilestones();\n            });\n          }\n        }\n      });\n    }\n  }\n};\n</script>\n\n<style scoped>\n.milestone-actions {\n  margin-top: 10px;\n  text-align: right;\n}\n</style>\n"]}]}